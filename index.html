<!DOCTYPE html>
<html>
<head>
  <title>Form Data</title>
  <meta charset="UTF-8">
  <style>
    body { font-family: Arial; max-width: 600px; margin: auto; padding: 20px; }
    input, button { display: block; margin: 10px 0; width: 100%; padding: 8px; }
    #updateBtn, #formUpdate, #idField { display: none; }
  </style>
</head>
<body>
  <h2>Form Input Data</h2>
  
  <!-- FORM INPUT DATA -->
  <form id="dataForm">
    <input type="text" id="nama" placeholder="Nama" required>
    <input type="number" id="umur" placeholder="Umur" required>
    <input type="text" id="alamat" placeholder="Alamat" required>
    <button type="submit">Kirim</button>
  </form>

  <!-- FORM CARI -->
  <h3>Cari dan Update Data</h3>
  <input type="text" id="searchNama" placeholder="Masukkan nama">
  <button onclick="cariData()">Cari</button>

  <!-- FORM UPDATE DATA -->
  <form id="formUpdate">
    <input type="hidden" id="idField">
    <input type="text" id="editNama" placeholder="Nama" required>
    <input type="number" id="editUmur" placeholder="Umur" required>
    <input type="text" id="editAlamat" placeholder="Alamat" required>
    <button type="button" id="updateBtn" onclick="updateData()">Update</button>
  </form>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycby0BMxT8GWmgbae0muP_PG9xl-pQG3sLEugh9hakOHXsM8JwQ2bNmWMQrrbUhVBGOmS/exec";

    // Kirim data baru
    document.getElementById('dataForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const data = {
        action: "add",
        nama: document.getElementById("nama").value,
        umur: document.getElementById("umur").value,
        alamat: document.getElementById("alamat").value
      };
      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(data),
        headers: { 'Content-Type': 'application/json' }
      })
      .then(res => res.json())
      .then(res => {
        if (res.success) alert("Data berhasil dikirim!");
        else alert("Gagal mengirim data.");
        document.getElementById('dataForm').reset();
      });
    });

    // Cari data
    function cariData() {
      const nama = document.getElementById("searchNama").value;
      fetch(`${scriptURL}?nama=${encodeURIComponent(nama)}`)
        .then(res => res.json())
        .then(res => {
          if (res.success) {
            const data = res.data;
            document.getElementById("idField").value = data.id;
            document.getElementById("editNama").value = data.nama;
            document.getElementById("editUmur").value = data.umur;
            document.getElementById("editAlamat").value = data.alamat;
            document.getElementById("formUpdate").style.display = "block";
            document.getElementById("updateBtn").style.display = "block";
          } else {
            alert("Data tidak ditemukan.");
            document.getElementById("formUpdate").style.display = "none";
          }
        });
    }

    // Update data
    function updateData() {
      const data = {
        action: "update",
        id: document.getElementById("idField").value,
        nama: document.getElementById("editNama").value,
        umur: document.getElementById("editUmur").value,
        alamat: document.getElementById("editAlamat").value
      };
      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(data),
        headers: { 'Content-Type': 'application/json' }
      })
      .then(res => res.json())
      .then(res => {
        if (res.success) alert("Data berhasil diperbarui!");
        else alert("Gagal memperbarui data.");
        document.getElementById("formUpdate").reset();
        document.getElementById("formUpdate").style.display = "none";
      });
    }
  </script>
</body>
</html>
